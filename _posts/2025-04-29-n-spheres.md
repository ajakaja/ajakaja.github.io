---
layout: article
title: "N-Spheres and Double Factorials"
math: true
aside: true
footnotes: true
tag: math
---

The Wikipedia articles [$$n$$-sphere](https://en.wikipedia.org/wiki/N-sphere) and [Volume of an $$n$$-ball](https://en.wikipedia.org/wiki/Volume_of_an_n-ball) and [Volume of a unit sphere](https://en.wikipedia.org/wiki/Unit_sphere#Volume_and_area) are lengthy and have the same information spread out in mysterious ways. I was finding them hard to use as a reference so I went to write my own... but then I got annoyed by the shape of the formulas, with their gamma functions and unintuitive $$\sqrt{\pi}$$ factors, so I starting trying to refactor them. It didn't really go anywhere, unfortunately, but I thought I'd post it anyway. 


<!--more-->

----------

# 1. Measures of Spheres

Here are the volumes and surface areas of $$n$$-spheres $$S^n$$ for the first few $$n$$.

$$
\begin{aligned}
S_0 &= 2 & V_1 &= 2r \\
S_1 &= 2 \pi r & V_2 &= \pi r^2 \\ 
S_2 &= 4 \pi r^2 & V_3 &= \frac{4}{3} \pi r^3 \\ 
S_3 &= 2 \pi^2 r^3 & V_4 &= \frac{1}{2} \pi^2 r^4 \\
\end{aligned}
$$

Here $$S_{n}$$ is a surface area of the $$n$$-sphere of radius $$r$$ and $$V_n$$ is the volume of the $$n$$-ball $$B^n$$ which is the _interior_ of $$S_{n-1}$$. So $$S_{n-1}$$ is the surface area of the ball that has volume $$V_n$$. $$S^0$$ is a pair of $$0$$-dimensional points, since there are two points on a line a distance $$r$$ from a single point, with surface "area" $$S_0 = 2$$, and $$B^1$$ is its interior, the line segment of length $$2r$$. $$S^1$$ is a circle, $$B^2$$ is a disc, $$S_2$$ is a sphere, $$B^3$$ is a ball. The numbers refer to the dimensionality of the object, which is why they're off-by-one for the spheres vs. balls: the two-dimensional disc has a one-dimensional boundary, etc. I've always found this a bit weird and confusing but there you go. Most of the time I will ignore the word "ball" and just refer to everything as a sphere: $$S^2(r)$$ refers to a two-dimensional sphere, whose surface area is $$S_2(r)$$ and whose volume is $$V_3(r)$$.

{% include image.html filename="2025-04-29-n-spheres/spheres.png" width="250px" %}

Wikipedia also talks about a $$V_0$$, a single point, which would be the interior of a $$(-1)$$-sphere, whatever that means. That seems dumb: there are no points in a $$0$$-dimensional space that are a distance $$r$$ from anything. One argument to keep it around, maybe, is that it does seem to respect the same recurrence relation as the others. Maybe it is kinda implying that $$N$$-spheres are products of smaller-dimensional spheres, and, as with $$0!=1,$$ the products start at $$1$$? I dunno.[^point]

[^point]: Another argument for including it: the intersection of the sphere $$S^2$$ with a plane is a copy of $$S^1$$ the intersection of $$S^1$$ with a line is a copy of $$S^0$$. I suppose the intersection of $$S^0$$ with a point (or a line, for that matter) is a copy of $$S^{-1}$$?

Here's the general form of the areas and volumes, as written on Wikipedia:

$$
\begin{aligned}
S_{n-1} &= \frac{2 \pi^{n/2}}{\Gamma(\frac{n}{2})} r^{n-1} & V_n &=  \frac{\pi^{n/2}}{\Gamma(\frac{n}{2} + 1)} r^n \\
\end{aligned}
$$

I have trouble thinking in terms of $$\Gamma$$ functions so here they are written in terms of $$n! = \Gamma(n+1)$$; we'll just let the factorial be defined on non-integers in the same way that $$\Gamma$$ is:

$$
\begin{aligned}
S_{n-1} &= \frac{2 \pi^{n/2}}{(\frac{n}{2}-1)!} r^{n-1} & V_n &=  \frac{\pi^{n/2}}{(\frac{n}{2})!} r^n \\
\end{aligned}
$$

That's better. Note that the relationship between the two is that $$\p_r V_n(r) = S_{n-1}$$, because the boundary of a ball is the derivative of its volume with respect to radius (as it has to be). So $$V_n(r) = V_n r^n$$ then $$S_{n-1}(r) = \p_r V_n(r) = n V_n r^{n-1}$$, which cancels out the $$(n/2)$$ in the factorial and puts a $$2$$ in the numerator.

But there's something annoying about these formulas. The main problem is how they _appear_ to have half-integer powers of $$\pi$$ for odd $$n$$, but they actually don't, because the half-integer factorial _also_ has a factor of $$\sqrt{\pi}$$, eg $$(\frac{1}{2})! = \frac{\sqrt{\pi}}{2}$$, and the two cancel out. (At the moment there's a comment in the Wikipedia article about this---that was me, I added that as I was writing this.) The other nuisance is that they just don't see obvious at all: _why_ are these the areas/volumes of $$n$$-spheres? Surely there is a more intuitive form?

------------

# 2. Derivations

We should probably derive them first.

The most straightforward way is to compute a big integral: each $$n$$-sphere is parameterizable by one angle $$\theta \in (0, 2\pi)$$ and then $$n-1$$ angles $$\phi_i \in (0, \pi)$$, plus a $$r \in (0, R)$$ if you want to get the volume of the interior (see [here](https://en.wikipedia.org/wiki/N-sphere#Spherical_coordinates)). Basically the first $$(0, 2\pi)$$ range is for the initial circle (picture the equator of a sphere), and then you repeatedly add polar angles akin to a sphere's $$\phi \in (0, \pi)$$ which adds up a bunch of circles of varying radii.

Then the formulas are what you get when you integrate over the whole surface, like 

$$S_2(R) = \int_0^{2 \pi} \int_0^{\pi} R^2 \sin (\phi) \d \phi \d \theta  = 4\pi R^2$$

Higher dimensions have more and more copies of $$\sin^k (\phi_i)$$ on each successive angular variable, and the integrals factor apart into a product of individual integrals. For instance

$$
\begin{aligned}
S_3(R) &=\int_0^\pi \int_0^\pi  \int_0^{2\pi}  R^3 \sin^2 (\phi_2) \sin( \phi_1) \d \phi_1 \d \phi_2 \d \theta \\
&=   \big[ \int_0^\pi R \sin^2 (\phi_2) \d \phi_2 \big] \big[ \int_0^\pi R \sin (\phi_1) \ d \phi_1 \big] \big[ \int_0^{2\pi} R \d \theta \big] \\
&= [\frac{\pi}{2} R] [2 R] [2 \pi R] \\
&= 2 \pi^2 R^3
\end{aligned}
$$

and when you work out the general case you get the above formulas.

The source of the "every other term has a factor of $$\pi$$" phenomenon is that $$\int_0^{\pi/2} \sin^k (\theta) d \theta$$ gives a factor of $$\pi$$ for even $$k$$ and not for odd, which in turn is because  $$\sin^2 \theta = \frac{1}{2}(1 - \cos 2 \theta)$$ while $$\sin^3 \theta = \sin \theta (1 - \cos^2 \theta) = \p_\theta (-\cos \theta + \frac{1}{3} \cos^3 \theta)$$, so the bare $$1$$ becomes a factor of $$\pi$$ in the even-powered integrals.[^wallis]

[^wallis]: See also [Wallis Integrals](https://en.wikipedia.org/wiki/Wallis'_integrals), although it uses different integration ranges.

By the way: actually producing that angular integral is a bit annoying if you only know the standard multivariable approach (a big Jacobian determinant) (hate that name). A better way to think about it is this:

Consider compute $$S_1 (R)$$. The circumference of a circle is given by integrating its arc length, which is subject to the condition that $$x^2 + y^2 = R^2$$, that is, if $$x = R \cos \theta$$, then $$y = \sqrt{R^2 - x^2} = R \sin \theta$$:

$$
\begin{aligned}
S_1(R) &= \int_{S_1(R)}  \| dS_1(R) \| \\
&= \int_{x^2 + y^2 = R^2} \| (dx, dy) \| \\
&= \int_{x^2 + y^2 = R^2} \sqrt{dx^2 + dy^2} \\
&= \int_{\theta = 0}^{2 \pi} \sqrt{(-R \sin (\theta) \d\theta )^2 + (R \cos (\theta) \d \theta)^2} \\
&= \int_0^{2\pi} R \d \theta \\
&= 2 \pi R
\end{aligned}
$$

To compute $$S_2(R)$$, which is the level set of $$x^2 + y^2 + z^2 = R^2$$, we can parse it as instead being constrained by

$$\rho^2 + z^2 = R^2$$

Where $$\rho = \sqrt{R^2 - z^2}$$ is the radius of the circle at height $$z$$. When we parameterize $$z = -R \cos \phi$$ for $$\phi \in (0, \pi)$$, then $$\rho = R \sin \phi$$. Now instead of the area being $$1 \times R \d \theta$$ for each differential $$\theta$$, it's $$S_1(R \sin \phi) \times R \d \phi$$ for each differential $$\phi$$:

$$
\begin{aligned}
S_2(R) &= \int_0^\pi S_1(R \sin \phi) R \d \phi \\
&= \int_0^\pi (2 \pi R \sin \phi) R \d \phi \\
&= 4 \pi R^2
\end{aligned}
$$

{% include image.html filename="2025-04-29-n-spheres/area.png" width="350px" %}

The nice thing about looking at it this way is that it's clear how that it generalizes: each sphere $$S_N(R)$$ is given by

$$S_N(R) = \int_0^\pi S_{N - 1}(R \sin \phi_N) R \d \phi_N$$

Starting from the base case of $$S_0(R) = 2$$. In light of this it is clear that the "special treatment" of the $$\theta \in (0, 2\pi)$$ coordinate is just a fluke: to make the pattern hold, it should really be thought of as 

$$
\begin{aligned}
S_1(R) &= \int_0^\pi S_0(R \sin \theta) R \d \theta \\
&= \int_0^\pi 2 R \d \theta \\
&= 2 \pi R
\end{aligned}
$$

That is: the circle $$S^1(R)$$'s interior is the sum of line segments of length $$\rho = 2 R \sin \theta$$, which are each copies of $$S_0(R)$$, and its boundary is the sum of the boundaries of those. (Of course, you could surely modify the other integrals to be in $$(0, 2\pi)$$ as well, with appropriate factors of $$2^{-N}$$. But this seems the most elegant to me).

A similar formula holds for volume: the volume $$V_N$$ is given by the integral of $$V_{N-1}$$, but now the integrand is $$dz = R \sin \phi_N d \phi_N$$.[^wedge]

$$
\begin{aligned}
V_N(R) &= \int_{-R}^R V_{N-1}(\sqrt{R^2 - z^2}) \d z \\
&=\int_0^\pi V_{N-1}(R \sin \phi_N) \d (-R \cos \phi_N) \\
&=\int_0^\pi V_{N-1}(R \sin \phi_N) R \sin (\phi_N)d \phi_N \\
\end{aligned}
$$

[^wedge]: The reason for this factor of $$\sin \phi_N$$ is that the integrand ought to consider $$V_{N-1}(R \sin \phi_N)$$ as a multivector oriented in the plane of the $$S^{N_1}$$ circle, and then the wedge product cancels out the horizontal component of $$d \phi_N$$: $$V_{N-1} \^ \d \phi_N = V_{N-1}\^ \sin \phi_N d \phi_N$$.

There are surely other geometric ways of constructing the spheres out of smaller spheres. In fact from [here](https://en.wikipedia.org/wiki/N-sphere#Polyspherical_coordinates) it sounds like there is a way to do this recursion with arbitrary $$S_p \times S_q$$ integrals ("polyspherical coordinates"), which is kinda neat, but I don't feel like going into it.

The reason I am hashing all of this out is that I want to understand exactly the recurrence relationship that $$S^{N}$$ has with $$S^{N-1}$$. There are other relationships that you find around but they're not very satisfying. For instance:

$$S_{n+1}(R) \? (2 \pi R) V_N(R)$$

A sphere is the product of a circle and a line segment? I don't understand why that would be, and I can't visualize it. Well: apparently it's because e.g. the sphere's surface area is the same as that of a (uncapped) cylinder of height $$2 R$$ and radius $$R$$ ($$2 \pi R \times 2R = 4 \pi R^2$$). But it's very hard to see intuitively why that should be the case, or why it would generalize.[^height]

[^height]: This corresponds to the fact that _per unit height_ a sphere's surface area is constant, so there really is one $$2\pi r$$'s sphere worth of area per $$2r$$ worth of diameter.

{% include image.html filename="2025-04-29-n-spheres/spheres-2.png" width="350px" %}

The other interesting recurrence is $$S_{n-1}(r) = \p V_n(r)/\p r$$, which is obvious: the surface area is the derivative of volume. (which is true for any figure, for a suitable definition of "radius"...) Since we know the power of $$r$$ this is really $$S_{n-1}(r) = \frac{n}{r} V_{n}(r)$$.

Here's a chart of various relations. I've also walked it into the negatives a bit because that's kinda fun to think about, although I won't be looking into that here...

{% include image.html filename="2025-04-29-n-spheres/nsphere.png" width="500px" %}

There are other recurrence-like relationships that deserve explanation but which I don't think I understand still. For instance, why is $$S_2(R) = 4 V_1(R)$$ intuitively? How do you cover a sphere with four circles of the same radius? I have no idea. Here's a [3b1b video](https://www.youtube.com/watch?v=GNcFjFmqEc8) about why, but imo none of the explanations make it _obvious_, I would say. I would like to understand a sense in which this relationship is completely natural. But I can't imagine what it would be, because it also has to explain why $$S_3$$ differs from $$V_3$$ by a factor proportional to $$\pi$$.

Anyway. Let's move on. I want to look more closely at the factorials.

------------

# 3. Investigations into factorials

For reasons that must somehow be very fundamental, spheres are closely tied to factorials. More on that later. But we'll need some Gamma function/factorial identities for integer and half-integer values to start unpacking things, and I don't like the ways that anyone else writes them so I need to write them out myself.

I am going to not use the symbol $$\Gamma$$, for starters: I'll be writing $$\Gamma(n)$$ as $$(n-1)!$$, even for non-integers. We should all be okay with analytically extending a function outside of the domain where it makes discrete sense (e.g. $$e^x$$). And I never liked that $$\Gamma$$ is defined to be off-by-one from factorials anyway. 

The first few half-integer terms of $$\Gamma$$/factorial are:

$$
\begin{aligned}
\Gamma(\frac{1}{2}) &= (-\frac{1}{2})! \\
&= \sqrt{\pi} \\ 
\Gamma(\frac{3}{2}) &= (\frac{1}{2})! \\
&= (\frac{1}{2}) \sqrt{\pi} \\
\Gamma(\frac{5}{2}) &= (\frac{3}{2})! \\
&= (\frac{3}{2}) (\frac{1}{2}) \sqrt{\pi}
\end{aligned}
$$

The general case for odd $$n$$: 

$$
\begin{aligned}
\Gamma(\frac{n}{2}) &= (\frac{n-2}{2})! \\
&= (\frac{n-2}{2}) (\frac{n-4}{2}) \ldots (\frac{3}{2}) (\frac{1}{2}) \sqrt{\pi} \\
&= \frac{(n-2)!!}{2^{(n-1)/2}} \sqrt{\pi} \\
(\frac{n}{2})! &= \frac{n!!}{2^{(n+1)/2}} \sqrt{\pi} \\
\end{aligned}\tag{$n$ odd}
$$

For even $$n$$:

$$
\begin{aligned}
\Gamma(\frac{n}{2}) &= (\frac{n-2}{2})! \\
&= (\frac{n-2}{2}) (\frac{n-4}{2}) \ldots (3)(2)(1) \\
&= \frac{(n-2)!!}{2^{(n-2)/2}} \\
(\frac{n}{2})! &= \frac{n!!}{2^{n/2}}
\end{aligned}\tag{$n$ even}
$$

Now dispensing with the $$\Gamma$$s, here is the value of the half-integer factorial for a single fixed _even_ $$n$$ and also the odd $$n-1$$ below it.

$$
\begin{aligned}
(\frac{n}{2})! &= \frac{n!!}{2^{n/2}} \\
(\frac{n-1}{2})! &= \frac{(n-1)!!}{2^{n/2}} \sqrt{\pi} \\
\end{aligned} \tag{$n$ even}
$$

And the other way around: odd $$n$$ and even $$n-1$$.

$$
\begin{aligned}
(\frac{n}{2})! &= \frac{n!!}{2^{(n+1)/2}} \sqrt{\pi} \\
(\frac{n-1}{2})! &= \frac{(n-1)!!}{2^{(n-1)/2}} \\
\end{aligned} \tag{$n$ odd}
$$

Finally, the same formulas in terms of $$k = n/2$$ when $$n$$ is even:

$$
\begin{aligned}
k! &= \frac{(2k)!!}{2^{k}} \\
(k-\frac{1}{2})! &= \frac{(2k-1)!!}{2^{k}} \sqrt{\pi} \\
\end{aligned}
$$

It's fun to note that their product combines to form one factorial again, times some factors[^gamma]

[^gamma]: More on that [here](https://en.wikipedia.org/wiki/Multiplication_theorem#Gamma_function%E2%80%93Legendre_formula). The Gamma function version is $$\Gamma(k) \Gamma(k + \frac{1}{2}) = \Gamma(2k) 2^{1-2k} \sqrt{\pi}$$. It's really more elegant with factorials.

$$k! (k-\frac{1}{2})! = \frac{(2k)!}{2^{2k}} \sqrt{\pi}$$

Okay, that should do it.

-------

Using the above factorial notations and identities, the general forms of the sphere surface area and volume are, for $$n$$ even:

$$
\begin{aligned}
S_{\text{even, }n-1} &= \frac{2 \pi^{n/2}}{\Gamma(\frac{n}{2})} r^{n-1} & V_{\text{even, }n} &=  \frac{\pi^{n/2}}{\Gamma(\frac{n}{2} + 1)} r^n \\
&= \frac{2 \pi^{n/2}}{(\frac{n}{2}-1)!} r^{n-1} & &=  \frac{\pi^{n/2}}{(\frac{n}{2})!} r^n  \\ 
&= \frac{2\pi^{n/2}}{\frac{n!!}{2^{n/2}} \frac{2}{n}} r^{n-1} & &=  \frac{\pi^{n/2}}{\frac{n!!}{2^{n/2}} } r^n  \\ 
&\boxed{= n \frac{(2\pi)^{n/2}}{n!!} r^{n-1}} & &\boxed{=  \frac{(2\pi)^{n/2}}{n!!} r^n}  \\ 
\end{aligned}
$$

and $$n$$ odd:

$$
\begin{aligned}
S_{\text{odd, }n-1} &= \frac{2 \pi^{n/2}}{\Gamma(\frac{n}{2})} r^{n-1} & V_{\text{odd, }n} 
&= \frac{\pi^{n/2}}{\Gamma(\frac{n}{2} + 1)} r^n \\
&= \frac{2 \pi^{n/2}}{(\frac{n}{2}-1)!} r^{n-1} & 
&= \frac{\pi^{n/2}}{(\frac{n}{2})!} r^n  \\ 
&= \frac{2 \pi^{n/2}}{\frac{n!!}{2^{(n+1)/2}} \sqrt{\pi}  \frac{2}{n}} r^{n-1} & 
&= \frac{\pi^{n/2}}{\frac{n!!}{2^{(n+1)/2}} \sqrt{\pi} } r^n  \\ 
& \boxed{= n \frac{(2) (2\pi)^{(n-1)/2}}{n!!} r^{n-1}} & 
& \boxed{= \frac{(2) (2\pi)^{(n-1)/2}}{n!!} r^n}  \\ 
\end{aligned}
$$

But these are _still_ awkward! At least now it's clear how to compute them. But it sucks that there's different values for $$n$$ even and $$n$$ odd.

Here are the four values for a single choice of integer $$k$$ with $$2k = n$$.

$$
\begin{aligned}
S_{\text{even, }2k-1} 
&=\boxed{(2k) \frac{(2\pi)^{k}}{(2k)!!} r^{2k-1}} & V_{\text{even, }2k}
&=\boxed{\frac{(2\pi)^{k}}{(2k)!!} r^{2k}}  \\ 
S_{\text{odd, }2k} 
&=\boxed{(2k+1)\frac{(2) (2\pi)^{k}}{(2k+1)!!} r^{2k}} & V_{\text{odd, }2k+1}
&=\boxed{\frac{(2) (2\pi)^{k}}{(2k+1)!!} r^{2k+1}} \\
\end{aligned}
$$

Note that the formulas for odd $$n$$ are off by a factor of:

$$
\begin{aligned}
S_{\text{even, }2k} &= \sqrt{\frac{\pi}{2}} S_{\text{odd, }2k} \\
V_{\text{even, }2k} &= \sqrt{\frac{\pi}{2}} S_{\text{odd, }2k} \\
\end{aligned}
$$

Isn't that just annoying?

Well, I thought about this for a long time and I think the "discrepancy" actually comes from how we've chosen to define the double factorial of an odd number. There's some discussion of this on Wikipedia for [double factorial](https://en.wikipedia.org/wiki/Double_factorial) (in the part about extending it to all complex numbers)... but I think they actually go the wrong direction with it. So here's my version. See what you think?

Going back to those half-integer factorial identities: 

$$
\begin{aligned}
k! &= \frac{(2k)!!}{2^{k}} \\
(k-\frac{1}{2})! &= \frac{(2k-1)!!}{2^{k}} \sqrt{\pi} \\
\end{aligned}
$$

And their product:

$$k! (k-\frac{1}{2})! = \frac{(2k)!}{2^{2k}} \sqrt{\pi}$$

Compare that to two double factorials offset by an integer, which is trivial:

$$(2k)!! (2k-1)!! = (2k)!$$

The half integer version is so similar. Consider $$k =3$$:

$$
\begin{aligned}
(2k)!!(2k-1)!! &= [6 \times 4 \times 2 \times 0!] \times [5 \times 3 \times 1!!] \\
&= 6 \times 5 \times 4 \times 3 \times 2 \times 1!! \times 0!! \\
&= 6! \\
& \\
(k!)(k - \frac{1}{2})! &= [ \frac{6}{2} \times \frac{4}{2} \times\frac{2}{2} \times\frac{0}{2}!] \times [\frac{5}{2} \times\frac{3}{2} \times\frac{1}{2} \times (-\frac{1}{2})!] \\
&= \frac{6 \times 5 \times 4 \times 3 \times 2 \times 1}{2^6}  \times 0! \times (-\frac{1}{2})! \\
&= \frac{6!}{2^6} \sqrt{\pi}
\end{aligned}
$$

The two are very nearly the same, except that the second continues after $$(1)$$ to include $$(-1)$$ in the list, which becomes $$(-1/2)!$$ and is where $$\sqrt{\pi}$$ comes from.

It sure feels suspicious. Could the definition of $$!!$$ be modified to make these exactly equal (up to the $$2^{2k}$$ factor)? Or is the definition of $$(1/2)!$$ wrong, like it shouldn't go down to $$(-1/2)!!$$? What's going on here? And the ultimate question has to be: morally, why is it that $$(-1/2)! = \Gamma(1/2) = \sqrt{\pi}$$?

--------

There is some other reasons to suspect that something is up with how $$\sqrt{\pi}$$ shows up in relation to double factorials.

Inverting the equations above gives the double factorial in terms of the single factorial for even/odd:

$$
\begin{aligned}
n!! &\sim 2^{n/2} (\frac{n}{2})! & \text{$n$ even} \\
n!! &\sim \frac{2^{n/2} (\frac{n}{2})!}{\sqrt{\pi/2}} & \text{$n$ odd}
\end{aligned}
$$

They're off by that factor of $$\sqrt{\pi/2}$$ again.

Also, look closely at these two formulas.

$$
\begin{aligned}
k! &= \frac{(2k)!!}{2^{k}} \\
(k-\frac{1}{2})! &= \frac{(2k-1)!!}{2^{k}} \sqrt{\pi} \\
\end{aligned}
$$

The latter should really be written in terms of $$k-1/2$$ throughout, right?

$$
\begin{aligned}
k! &= \frac{(2k)!!}{2^{k}} \\
(k-\frac{1}{2})! &= \frac{(2k-1)!!}{2^{k-1/2}} \sqrt{\pi/2} \\
\end{aligned}
$$

What would that mean? Well, here's an idea: it could mean that the double-factorial of $$5 = 2(3-1/2)$$ should really only contain $$3-1/2$$ terms, not $$3$$ terms:

$$
\begin{aligned}
3! &= \frac{6 \times 4 \times 2}{2 \times 2 \times 2} \\
(3-\frac{1}{2})! &\? \frac{5 \times 3 \times \sqrt{1}}{2 \times 2 \times \sqrt{2}}
\end{aligned}
$$

...whatever that means! And then $$\frac{(-1/2)!}{\sqrt{2}} = \frac{\sqrt{\pi}}{\sqrt{2}}$$ is actually the missing additional term. Which implies something like:

$$(\frac{1}{2})! = \sqrt{\frac{1}{2}} \times 0! = \sqrt{\frac{1}{2}} \times \sqrt{\frac{1}{2}} \times (-\frac{1}{2})! = \frac{1}{2} \sqrt{\pi}$$

I don't know _why_ the "half-factorial" of $$1/2$$ gives a factor of $$1/\sqrt{2}$$, or what value it would take at other points. But, combining these observations, I believe the following is in some sense morally correct.

-----

# 4. Factorials as multiplicative integrals

I have a feeling that factorials should be thought of like integrals: they should have a start point and an endpoint, so they are the product of numbers in a range. The classical factorial $$n!$$ starts at $$0$$ and ends at $$n$$, which we write as a [product integral](https://en.wikipedia.org/wiki/Product_integral):[^product]

[^product]: I am very much making this up as I go along. But it's not too weird, promise.

$$n! = \prod_0^n d^{\times}(x!) = x!/0!$$

But othe endpoints are possible, which accounts for the discrepancies in the definitions.

The meaning of $$d^{\times}f$$ in this case is

$$df = \frac{f(x+dx)}{f(x)}$$

For instance

$$d^{\times}(x!)\|_{n-1}^n = \frac{n!}{(n-1)!} = n$$

Product integrals obey multiplicative versions of the addition properties of ordinary integrals:

$$[\prod_{0}^a d^{\times}(x!)] [\prod_{a}^b d^{\times}(x!)] = \prod_{0}^b d^{\times}(x!)$$

In particular, the value $$\sqrt{\pi}$$ is for some reason equivalent to integration from $$-\infty$$ to $$-1/2$$:

$$\sqrt{\pi} = \prod_{-\infty}^{-1/2} d^{\times}(x!)$$

(Best not to interpret that too literally, though. It's more like how we assign values to divergent series.)

Hence there are three things you could mean by $$(k-\frac{1}{2})!$$, depending on what bounds you're using, which could be any of $$(-\infty, k-\frac{1}{2})$$, $$(-\frac{1}{2}, k - \frac{1}{2})$$, or $$(0, k-\frac{1}{2})$$ (which is the one that actually "has" $$(k-\frac{1}{2})$$ terms in it). The integrals are:

$$
\begin{aligned}
\prod_{-\infty}^{-1/2} d^{\times}(x!) &= \sqrt{\pi} \\
\prod_{-1/2}^0 d^{\times}(x!) &= \frac{1}{\sqrt{2}}\\ 
\prod_{0}^{k-1/2} d^{\times}(x)! &= \frac{k!!}{2^{k-1/2}} \\ 
\end{aligned}
$$

Which is why the "classical" value is

$$
\begin{aligned}
(k-\frac{1}{2})! &= \prod_{-\infty}^{k-1/2} d^{\times}(x!) \\
&= \prod_{-\infty}^{-1/2} d^{\times}(x!) \prod_{-1/2}^0 d^{\times}(x!) \prod_{0}^{k-1/2} d^{\times}(x!) \\
&= \sqrt{\pi} \frac{1}{\sqrt{2}}\frac{k!!}{2^{k-1/2}} \\
&= \frac{k!!}{2^k} \sqrt{\pi} \\
\end{aligned}
$$

We can repeat the same thing for the double-factorial. From $$(\frac{5}{2})! = 5!!/ 2^{5/2}$$, it seems like the pattern should be 


$$\prod_{2a}^{2b} d^{\times}(x!!) = 2^{b-a}\prod_{a}^{b} d^{\times}(x!)$$

Which I'm _pretty_ sure can be justified by the following calculus:

$$
\begin{aligned}
d^{\times}[x!!] &= d^{\times} [2^{x/2} (\frac{x}{2})!] \\
&= \frac{2^{(x + dx)/2} (\frac{x+dx}{2})!}{2^{x/2} (\frac{x}{2})!} \\
&= d^{\times}[2^{x/2}] d^{\times}[(\frac{x}{2})!]
\end{aligned}
$$

Note that multiplying two terms with $$d^{\times}$$ is equivalent, in the additive calculus, to just adding two separate expressions like $$\int dx + f(x) dx = \int dx + \int f(x) dx$$, meaning that we can just separate the integrals:

$$
\begin{aligned}
\prod_a^b d^{\times}[x!!] &= \prod_a^b d^{\times}[2^{x/2}] d[(\frac{x}{2})!] \\
&= \prod_a^b d^{\times}[2^{x/2}] \prod_a^b d[(\frac{x}{2})!] \\
&= 2^{(b-a)/2} \prod_{a/2}^{b/2} d^{\times}[x!]
\end{aligned}
$$

Anyway, this means that we can associate each term in $$(2k-1)!!$$ with a corresponding term in $$(k-1/2)!$$:

$$
\begin{aligned}
(2k-1)!! &= \prod_{-\infty}^{2k-1} d^{\times}(x!!) \\
&= \prod_{-\infty}^{-1} d^{\times}(x!!) \prod_{-1}^0 d^{\times}(x!!) \prod_{0}^{2k-1} d^{\times}(x!!) \\
&= \big[2^{(\infty-1)/2??} \prod_{-\infty/2}^{-1/2} d^{\times}(x!)\big] \big[\sqrt{2} \prod_{-1/2}^{0} d^{\times}(x!)\big] \big[\frac{1}{2^{k-1/2}} \prod_{0}^{k-1/2} d^{\times}(x!)\big] \\
&= \big[2^{(\infty-1)/2??} \sqrt{\pi} \big] \big[\sqrt{2} \frac{1}{\sqrt{2}} \big] \big[2^{k-1/2} \frac{(2k-1)!!}{2^{k-1/2}}\big] \\
\end{aligned}
$$

Evidently:

$$
\begin{aligned}
\frac{(2k-1)!!}{0!!} &= \frac{(k-1/2)!}{0!} \\ 
\frac{0!!}{(-1)!!} &= 1 \\
\frac{(-1)!!}{(-\infty)!!} &= 2^{(\infty-1)/2} \sqrt{\pi}
\end{aligned}
$$

Well, that infinity is pretty annoying. But I guess we can pretend to separate it out and leave the finite part:

$$\frac{(-1)!!}{(-\infty)!!} \? 2^{\infty/2} \sqrt{\frac{\pi}{2}}$$

Which is, I guess, _an_ argument for $$(2k-1)!!$$ having a factor of $$\sqrt{\pi/2}$$. Although yeah, pretty sus.[^sus]

[^sus]: $$2^{\infty/2}$$ is really $$\sqrt{2^{\infty}}$$, where half as many copies of $$2$$ were included compared to $$(-1)!$$ because the double factorial skips every other value. Inasmuch as $$(-1/2)! = (-1/2)(-3/2)(-5/2)\ldots = \sqrt{\pi}$$, $$(-1)!! = (-1)(-3)(-5)\ldots = 2^{\infty/2}\sqrt{\pi/2} $$, I guess? (note: there is not really any reason to think this is a sensible way to assign a value to an infinite product. but we're just playing around here right?)


The larger point is: there are competing definitions of factorials and double-factorials here, and the difference is that we had been neglecting what the endpoints of their "integrals" are. When we include those then some of the ambiguity goes away: the combinatoric double factorials stop at $$n=0$$ or $$n=1$$, as makes sense in combinatoric problems, while---for whatever reason!---the $$n$$-sphere ones stop at $$n=-\infty$$ (whilst dropping the mysterious infinite factor that comes along with that).

In particular this cleans up some of the confusion Wikipedia describes about alternate extensions of the double-factorial to the rest of the reals. The different definitions they use amount to different choices of where to stop the "integral". Their "inverted recurrence" $$n!! = (n+2)!!/(n+2)$$ is also correct: it's the ratio of two factorials with the infinite part removed.

Note that even the even-valued double-factorials must do the same thing in this scheme. There is no guarantee that $$0!! = 1$$ anymore now that divergent series are involved; it has to be interpreted as $$\prod_0^0 d^{\times}(n!!) = 1$$. Moreover, we can't assume that $$\prod_{-\infty}^0 d^{\times}(n!!) = (0) \times (-2)!!$$ or anything, because $$(-2)$$ might be some infinite thing also. Basically everything has devolved into madness.

-----

By the way, if the multiplicative integrals bother you, you can always convert them into additive integrals with logarithms:

$$\log \prod_a^b d^{\times}[x!] = \int_a^b d \log(x!) = \log(b!) - \log(a!)$$

One nice thing about this is that it means the problematic infinity term in $$n!!$$ gets split out into its own constant term (which is just a notational difference, but maybe less upsetting to look at?).[^entropy] Using $$d^{\times}(x!!) = d^{\times} (2^{x/2}) d^{\times} (\frac{x}{2}!)$$:

$$
\begin{aligned}
\log \prod_{-\infty}^{2k-1} d^{\times}(x!!) &= \prod_{-\infty}^{2k-1} \log  d^{\times} (2^{x/2})  + \log d^{\times} (\frac{x}{2}!) \\
&= \int_{-\infty}^0 d \log(2^{x/2}) + \int_{-\infty}^{2k-1} d \log (\frac{x}{2}!) \\ 
&= [\log 2^{0/2}-\log 2^{-\infty/2}] + \log (k - \frac{1}{2})! \\
&=  (\infty) \ln (\sqrt{2}) + \log (k - \frac{1}{2})! 
\end{aligned}
$$

I dunno. Maybe interesting.

[^entropy]: I am reminded of the sense in which [entropy]({% post_url 2018-02-23-entropy-1 %}) of continuous distributions should be thought of being relative to an "entropy of continuum": $$S[\mathcal{U(0,2)}] = 1 + S[\mathcal{U}(0,1)] = 1 + \log 2^X = 1 + X$$, where $$X$$ is the number of bits to specify a point in a uniform distribution: theoretically infinite, in practice just very large and unspecified. (Also of general renormalization trickery.)

Two, it's clearly possible to generalize all of this to higher-dimensional multifactorials, like $$n!!! = n \times (n-3) \times \ldots$$. Suppose we define $$F_1(n) = n!$$ and $$F_2(n) = n!!$$, etc. The values are always considered to be relative:

$$\prod_a^b d^{\times} F_k(n) = F_k(b)/F_k(a)$$

But we may safely think of them all as being relative to $$0$$: $$F_k(n) = F_k(n)/F_k(0)$$, such that $$F_1(5) = 5!/0! = 5!$$ and $$F_1(-1/2) = (-1/2)!/0! = \sqrt{\pi}$$.

Since $$n\underbrace{!!!!!}_{k} = n \times (n-k)\underbrace{!!!!!}_{k}$$, they must have

$$F_k(n) = n F_k(n-k)$$

And the identity we found above relates $$F_k$$ and $$F_1$$ like this:

$$F_1(\frac{n}{k}) = \frac{F_k(n)}{k^{n/k}}$$

e.g.

$$(\frac{5}{2})! = F_1(\frac{5}{2}) = \frac{F_2(5)}{2^{5/2}} = \frac{5!!}{2^{5/2}}$$

But keep in mind that this is not the classical value of $$(5/2)!!$$, since that would be given by $$F_1(5/2) / F_1(-\infty) = \frac{5!! \sqrt{\pi}}{2^{3}}$$. Really these have no way at all of telling you any absolute value compared to $$-\infty$$, unfortunately.

(This generalization is on Wikipedia [also](https://en.wikipedia.org/wiki/Double_factorial), but in a different notation. I prefer my way of thinking about it with integrals, though.) 

Well. That was fun to think about, but not clearly useful for anything at all. It did put to rest, for me at least, the confusion about the various ways of generalizing $$n!!$$ to non-integers: I think it's basically not possible to express it neatly if you're not using the product-integral sense of a factorial. But somehow I do not feel like I have learned anything new about spheres.

Actually no. There was one useful thing. _If_ we adjust the definition of the double-factorial on odd numbers like this:

$$(2k-1)!!_{\text{new}} = \sqrt{\frac{\pi}{2}} (2k-1)!!_{\text{old}}$$

Which is to say to define 

$$1!! = 1 \times (-1)!! = \sqrt{\frac{\pi}{2}}$$

instead of $$1$$, then it always the case that

$$(\frac{n}{2})! = \frac{(n)!!_{\text{new}}}{2^{n/2}}$$

Which means that we can write the spherical area and volume formulas like so, for all $$n$$:

$$
\begin{aligned}
S_{n-1}(r) &= \frac{2 \pi^{n/2}}{(\frac{n}{2}-1)!} r^{n-1} & V_n (r) &= \frac{\pi^{n/2}}{(\frac{n}{2})!} r^n \\
&= \frac{2 \pi^{n/2}}{(n-2)!!_{\text{new}}/2^{(n-2)/2}} r^{n-1} & & = \frac{\pi^{n/2}}{n!!_{\text{new}}/2^{n/2}} r^n \\
&= \frac{(2\pi)^{n/2}}{(n-2)!!_{\text{new}}} r^{n-1} & & = \frac{(2\pi)^{n/2}}{n!!_{\text{new}}} r^n \\
\end{aligned}
$$

Which... is a smidge more symmetric than the old version, I guess?

------

# 5. More on spheres then

A few miscellaneous observations I will make in a desperate attempt to connect factorials and spheres more directly.

First, one of the ways to compute the volume of a sphere is to consider Gaussian integral over all the same variables

$$I = \int_{-\infty}^{\infty} e^{-x^2} \d x$$

The normal trick for evaluating $$I$$ is to square it and then change variables to $$(r, \theta)$$:

$$
\begin{aligned}
I^2 &= [\int_{-\infty}^{\infty} e^{-x^2} \d x] [\int_{-\infty}^{\infty} e^{-y^2} \d y] \\
&= \int_{\bb{R}^2} e^{-(x^2 + y^2)} \d x \d y \\
&= \int_0^\infty \int_0^{2 \pi} e^{-r^2} r \d r \d \theta \\
&= 2 \pi (-\frac{1}{2} e^{-r^2} \big|_0^{\infty}) \\
&= \pi \\
I &= \sqrt{\pi}
\end{aligned}
$$

But in fact you can do this for as many variables as you want, using the substitution $$z = r^2$$, and it turns out the volume of $$n$$-sphere instead.

$$
\begin{aligned}
I^N &= \int_{\bb{R}^N} e^{-(x_1^2 + x_2^2 + \ldots x_N^2)} \d^N x \\
&= \int_0^{\infty} \int_{S^{N-1}(r)} e^{-r^2} \d r \d S^{N-1} \\
&= S_{N-1}  \int_0^{\infty} e^{-r^2} r^{n-1} \d r \\
&=  S_{N-1} \frac{1}{2} \int_0^{\infty} e^{-z} z^{n/2 - 1}  \d z \\
(\sqrt{\pi})^n &= S_{N-1} \frac{1}{2} \Gamma(\frac{n}{2}) \\
S_{N-1} &= \frac{2 \pi^{n/2}}{(\frac{n}{2} - 1)!}\\
\end{aligned}
$$

Which is cute!

Also amusing is that we can interpret $$I = \int_{-\infty}^{\infty} e^{-x^2} \d x = 2 \int_0^\infty e^{-x^2} \d x$$ as the $$n=1$$ case of this: the factor of $$2$$ is the value of $$S_0$$, and the value $$\int_0^{\infty} e^{-x^2} \d x = \frac{1}{2} \int_0^\infty e^{-z} z^{-1/2} \d z = \sqrt{\pi}$$ is the value of $$\frac{1}{2} \Gamma(\frac{1}{2})$$. But weird also, right? What's going on? I dunno.[^lemniscate]

[^lemniscate]: Other values of $$\Gamma$$ at non-integers might generally do the same thing but with "shapes" than circles. The example I'm aware of is $$\Gamma(\frac{1}{4}) = (-\frac{3}{4})! = \sqrt{2 \varpi \sqrt{2 \pi}}$$, where $$\varpi$$ is the [lemniscate constant](https://en.wikipedia.org/wiki/Lemniscate_constant), a number that serves a similar role to $$\pi$$ for circles but for a lemniscate which is connected to $$x^4$$ rather than $$x^2$$ ($$\varpi = 2 \int_0^1 \frac{1}{\sqrt{1-x^4}} \d x $$). I don't know anything about that; I just think it's cool. Anyway other values of $$\Gamma$$ are related to the values of elliptic integrals, so maybe there's some general logic to the whole thing for which $$n=1/2$$ is the special and best-behaved case? Dunno.

Another place to look for logic in fractional factorials and square roots of $$\pi$$ is in [fractional calculus](https://en.wikipedia.org/wiki/Fractional_calculus). A natural way[^frac] to define a "square root of a derivative" operator $$D^{1/2}$$ is to generalize from

[^frac]: What I've written here about fractional derivatives is probably not actually correct. Various comments online point out that fractional derivatives are generally non-local extensions, since (e.g.) you can define them with the Fourier transform $$\F[\p^a f(x)] = (ik)^a \hat{f(k)}$$ but then inverse-transforming that is probably non-local. But it's such an aside that I'm not going to bother researching it further.

$$D^{k} \frac{x^{n}}{n!} = \frac{x^{n-k}}{(n-k)!}$$

This basically creates an operator that has $$D^{1/2} \circ D^{1/2} = D$$ (it also basically works as an integral with negative powers also, but there's a lot of ambiguity in the definition).

The half-derivative of a polynomial then produces another polynomial with a factor of $$\sqrt{\pi}$$, e.g.

$$D^{1/2} x^n = \frac{n!}{(n-1/2)!} x^{n-1/2}$$

and in particular, proceeding naively, you would get a series like this:

$$
\begin{aligned}
D^{1/2} x^{1/2} &= (\frac{1}{2})! x^0 &= \frac{\sqrt{\pi}}{2} \\
D^{1/2} x &= \frac{1}{(\frac{1}{2})!} x &= \frac{1}{\sqrt{\pi}/2} x^{1/2} \\ 
D^{1/2} x^{3/2} &= (\frac{3}{2}!) x &=  \frac{3\sqrt{\pi}}{4} x \\
D^{1/2} x^{2} &=\frac{2!}{(\frac{3}{2})!}x^{3/2} &= \frac{8}{3 \sqrt{\pi}} x^{3/2} \\
\end{aligned}
$$

I am including this because, if nothing else, because it shows this same "multiplicative series with $$\pi$$s on every other term" phenomenon that $$n$$-sphere volumes also do. The basic _reason_ for it is that it is (a) a factorial series where (b) every other term is proportional to $$\sqrt{\pi}$$, hence the products look like 

$$\sqrt{\pi} \times \frac{a}{b \sqrt{\pi}} \times \frac{b \sqrt{\pi}}{c}  \times \frac{c}{d \sqrt{\pi}} \ldots$$

which causes the oscillation. If nothing else I am glad to understand _what kind of formula_ could give this result. (I assume a similar series could be produced with other products of fractional factorials to get similar products with different periods). 

Also, recall from earlier: the other way to get a series like this, where very other term has a factor of $$\pi$$, is to compute $$\int_0^\pi \sin^k (\phi) d \phi$$ for different values of $$k$$. I guess at some level these two processes must be doing the same kind of thing.

Anyway I still wonder why it is that spheres get involved in this "half-integer" sequence.

$$
\begin{aligned}
S_{n-1}(r) &= \frac{2 \pi^{n/2}}{(\frac{n}{2}-1)!} r^{n-1} & V_n (r) &= \frac{\pi^{n/2}}{(\frac{n}{2})!} r^n \\
\end{aligned}
$$

Feels like there must be some elegant explanation for it that I'm not seeing.

One thing that's a bit interesting is to consider the ratio $$S_n/V_n$$:

$$
\begin{aligned}
\frac{S_n}{V_n} &= \frac{2 \pi^{(n+1)/2} r^{n}}{(\frac{n+1}{2}-1)!}  \times \frac{ (\frac{n}{2})! }{ \pi^{n/2} r^n} \\
&= 2 \pi^{1/2} \frac{ (\frac{n}{2})!} {(\frac{n}{2} - \frac{1}{2})!}
\end{aligned}
$$

These give, for instance, the ratio of a sphere's surface area to a circle's area: 

$$\frac{S_2}{V_2} = 2 \sqrt{\pi} \frac{1!}{(\frac{1}{2}!)} = 4$$

All of this interesting $$\sqrt{\pi}$$ structures comes from the $$\frac{ (\frac{n}{2})!} {(\frac{n}{2} - \frac{1}{2})!}$$ term, which, recall is equivalent using our "new" double factorial to 

$$\frac{ (\frac{n}{2})!} {(\frac{n}{2} - \frac{1}{2})!} = \frac{(n)!!_{\text{new}} / 2^n}{(n-1)!!_{\text{new}} / 2^{n-1/2} }$$


If $$n$$ is even, using $$(n-1)!!_{\text{new}} = \sqrt{\frac{\pi}{2}} (n-1)!!$$:

$$
\begin{aligned}
I(n) = \frac{ (\frac{n}{2})!} {(n - \frac{1}{2})!}  &= \frac{(n)!!}{\sqrt{\pi} (n-1)!!} \\
\end{aligned}
$$

(Aside: defining $$I(n)$$ as the above, the ratio $$\lim_{n \ra \infty} I(n+1/2)/I(n)$$ gives the [Wallis Product](https://en.wikipedia.org/wiki/Wallis_product) formula for $$\pi$$, because the ratio of the factorials eventually goes to one, leaving only the $$\pi$$ factor.)


-----------


The point of all this was to try to make some sense for myself of the fact that $$\sqrt{\pi}$$s are doing weird things in the formulas for $$N$$-spheres. I don't think I really got to the bottom of it, but along the way I do think I settled some confusions about factorials for myself.

I've left all my notes here in case anyone (or me in the future) can see some connection that I'm missing. I really want to see some "natural" way for those formulas to show up: some geometric construction that has these properties:

1. It clearly produces $$N$$ spheres from $$N-1$$ spheres
2. It clearly involves a factor of $$\sqrt{\pi}$$
3. And it's clear where the oscillating factor of $$\sqrt{\pi}$$ that cancels that one out is coming from.

I didn't find that, but I guess that's okay.

(Stray thought that I didn't get to: consider how $$4 \pi r^2 = (2\pi r)(2r)$$, the outside of a cylinder of the same circumference and height as the sphere. Going from the sphere to that cylinder involves deforming _one_ of its principal curvatures (which are both $$1/r$$) to be flat, so changing the principal curvatures from $$(\frac{1}{r}, \frac{1}{r})$$ to $$(\frac{1}{r}, 0)$$. 

So maybe the argument I'm looking for is something like: you can change one curvature without affecting area, but changing two deforms it by a factor of $$\pi$$, hence why each odd-numbered $$S_N$$ jumps up by a factor proportional to $$\pi$$? If so I would expect that in higher dimensions the other curvatures (of which there are $$N$$ total) would exhibit similar phenomenon, and maybe the [mixed volumes](https://en.wikipedia.org/wiki/Mixed_volume) of the $$N$$-spheres would have the same behavior. But, not sure, and I don't have the knowledge loaded to investigate that right now.)