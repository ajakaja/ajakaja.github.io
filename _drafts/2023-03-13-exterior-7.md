---
layout: blog
title: "Simplex Boundaries and Volumes"
footnotes: true
math: true
aside: true
tags: notes
---

<!--more-->

------------

## 1. The Boundary Operator

Okay, rehash: a (proper) $$k$$-simplex in oriented projective space $$\bb{O}^n$$ is an oriented $$k$$-triangle defined by $$k+1$$ points, like $$\alpha = (p_0 p_1 \ldots p_k)$$, and it defines a particular oriented affine subspace, which OPG calls a $$k$$-flat, of $$\bb{R}^{n}$$. This flat can be represented as a multivector in homogenous coordinates, an element of $$\^ \bb{R}^{n+1}$$, via $$\alpha = (\b{w} + p_0) \^ (\b{w} + p_1) \^ \ldots (\b{w} + p_k) \in \^^{k+1} \bb{R}^{n+1}$$, where $$\b{w}$$ is the dummy homogenous coordinate, which I always put at the front. The 'projective plane' is the plane where $$w=1$$, and unlike un-oriented projective geometry, we only identify points up to a _positive_ factor, so e.g. $$(1, x, y)$$ and $$(-1, -x, -y)$$ are two distinct orientations of the same point. Got it?

The area of the triangle $$(abc)$$ (a $$2$$-simplex) in space is given by

$$\text{area}(abc) = \frac{1}{2}(b-a) \^ (c-a)$$

that is, half of the wedge product of its sides (without the $$\frac{1}{2}$$ of course it is the area of the parallelepiped spanned by $$ab$$ and $$ac$$). Of course that representation is a bivector, so you have to take its magnitude via $$\| \alpha \| = \sqrt{\alpha \cdot \alpha}$$ to get a scalar.

That representation is a bit weird because it privileges one of the points over the other two, so it's better to expand it into this nicely symmetric form: 

$$\text{area}(abc) = \frac{1}{2}(ab + bc + ca)$$

That object, $$ab + bc + ca$$, is interesting: each part is one of the line segments of the triangle. It can be viewed as summing together three separate simplexes, the simplexes that form the boundary of $$(abc)$$. Apparently, to compute the volume of the triangle $$(abc)$$, we compute its boundary chain, which is a formal linear combination of the simplexes $$(ab) + (bc) + (ca)$$, and then add each of their volumes. This turns out to work for simplexes of every dimension.

The operation of taking the boundary of a simplex is a common operation on simplexes anywhere they're used. The boundary of the $$k$$-simplex $$p = (p_0, p_1, \ldots p_k)$$ is the chain / formal linear combination of $$(k-1)$$-simplexes given by:

$$\p p = \sum_j (-1)^{j} (p_0, \ldots p_{j-1}, p_{j+1}, \ldots p_k)$$

And then extended linearly over chains. That is: we omit one vertex at a time and produce an alternating sum of the results. Examples:

$$\begin{aligned}
\p(a) &= () \\
\p(ab) &= (b) - (a) \\
\p(abc) &= (bc) - (ac) + (ab)  = (ab) + (bc) + (ca) \\
\p(abcd) &= (bcd) - (acd) + (abd) - (abc)
\end{aligned}$$

So the boundary consists, naturally, of one simplex for each facet (which is the generic term for a vertex, edge, face, etc of a figure) of $$p$$. We define the boundary of a $$1$$-simplex (a point) as the empty set.

The boundary operator produces the oriented boundary $$(k-1)$$-chain of the $$k$$-simplex $$p$$. Except for $$k=1$$, these boundary simplexes will share edges with each other, tiling $$p$$ such that their edges cancel out. For instance: in the triangle $$(abc)$$, with $$\p(abc) = (ab) + (bc) + (ca)$$, each of the points $$(a), (b), (c)$$ is the endpoint of one side and the initial point of another. Likewise for the edges shared by faces in a tetrahedron, or any more complex closed shape. So it will be no surprise that "the boundary of a boundary is $$0$$", in the sense that all their components formally cancel:

$$\p^2 = 0$$

You can see it happen with the formula for $$\p$$:

$$\begin{aligned}
\p^2(abc) &= \p(ab + bc + ca) \\
&= b + \neg a + c + \neg b + a + \neg c \\
&= (b-a) + (c-b) + (a-c) = 0
\end{aligned}$$

(This ends up mattering a lot in calculus and algebraic geometry, but let's not worry about that here.) 

We can also take the boundary of chains (formal linear combinations of simplexes), and it does what we would like. For instance the boundary of a chain of connected line segments that don't form a closed loop is the (formal) difference of their endpoints:

$$\p((ab) + (bc) + (cd)) = (b) - (a) + (c) - (b) + (d) - (c) \\
= (d) - (a)$$

So the internal points cancel out, leaving only the endpoints of the chain. 

----------

Given a multivector representation for $$(abc)$$ in $$\bb{R}^3$$ (which would have only one coordinate), you can't directly produce $$\p(abc)$$. But when you write $$(abc)$$ as a multivector in $$\bb{O}^3 \sim \bb{R}^4$$, you can:

$$(\b{w} + a) \^ (\b{w} + b) \^ (\b{w} + c) = \b{w} \^ (a \^ b + b\^ c + c\^a) + a \^ b \^ c$$

(The latter term is the volume of the tetrahedron $$(\mathcal{O}abc)$$ which is not obviously useful for anything?) This might be the reason OPG seems useful. It is basically a way of tricking yourself into keeping track of $$(ab) + (bc) + (ca)$$.

By the way, another way to write the same boundary is as the $$\^^k$$ of a $$(k) \times (k + 1)$$ matrix:

$$\^^2 \begin{pmatrix} a \\ b \\ c \\ \end{pmatrix} = \begin{pmatrix} a \^ b \\ b \^ c \\ c \^ a \end{pmatrix}$$

This might be 'right' way to think about OPG calculations without actually moving into homogenous $$\bb{R}^{n+1}$$ space.

--------

## 2. The Shoelace Formula


We can represent a general polygon (or any polytope, which is the generic term for polygon/polyhedra/etc) as a chain of the oriented simplexes which compose it. For example, consider the five-sided figure $$P$$ created by the points $$(a,b,c,d,e)$$ in a plane. $$P$$ can be decomposed into simplexes as $$P = (abc) + (acd) + (ade)$$. Then the boundary operator produces only the _external_ boundaries, because the internal boundaries all cancel out:

$$\begin{aligned}
\p P &= \p(abc) + \p(acd) + \p(ade) \\
&= (bc) + (ca) + (ab) + (cd) + (da) + (ac) + (de) + (ea) + (ad) \\
&=[(ac) - (ac)] + [(ad) - (ad)] + (bc) + (ab) + (cd) + (de) + (ea) \\
&= (ab) + (bc) + (cd) + (de) + (ea)
\end{aligned}$$

As with the triangle before, this (well, with factor of $$\frac{1}{2}$$) is the area of the figure, when regarded as a sum of multivectors. Thus:

$$\text{area}(P) = \frac{1}{2} [\p(abc) + \p(acd) + \p(ade)] = \frac{1}{2}[(ab) + (bc) + (cd) + (de) + (ea)]$$

with each simplex being considered as a multivector $$\in \bb{R}^n$$. All of the 'interior' boundaries, such as $$(ac)$$, have dropped out due to appearing twice in the sum with opposite signs. In fact, this is just the [shoelace formula](https://en.wikipedia.org/wiki/Shoelace_formula) for the area of a polygon, about which I also wrote an [expository article]({{ site.baseurl }}{% post_url 2018-08-06-oriented-area %}) before I had wedge products in any depth. Although now it works nicely on polygons floating in higher-dimensional spaces.

Clearly the same form should generalize to any $$k$$-simplex in any dimension as well:

$$\vol_k(P) = \frac{1}{k!} \p P$$

It gets a lot harder to use on higher-dimensional objects, though, just because you have to decompose a $$n$$-polytope into a chain of $$n$$-simplexes in the first place, which is painful in practice -- because, for instance, you can specify a cube with 8 points, but specifying its 6 sides as a sum of triangles takes 6 x 2 x 3 points. But if you do have a polytope's boundary broken up into triangles (which in computer graphics you usually do!), you can compute its oriented volume.

So the volume of a $$k$$-simplex $$P$$ is $$\frac{1}{k!} \p P $$, a multivector $$\in \^^k \bb{R}^n$$. To get a scalar value we have to take its magnitude

$$\| \text{vol}(P) \|^2 = \frac{1}{(k!)^2} \Vert \p P \Vert^2 $$

For a line segment $$(ab)$$ this is its squared length: $$\| \text{vol}(ab) \|^2 = \| b - a \|^2$$, which reminds us that the vector representation of a line segment is its vector displacement. For a point, it doesn't seem to be meaningful: $$\|\text{vol}(p)\|^2 = \frac{1}{0!^2} \| \emptyset \|^2 \stackrel{?}{=} 1$$, but that's okay.

{% include ea.html %}