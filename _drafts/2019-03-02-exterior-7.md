---
layout: blog
title: "Simplex Volumes and Boundaries"
footnotes: true
math: true
aside: true
tags: notes
---

More on simplexes in oriented projective geometry (OPG), since they are connected to everything else. I'm returning to using EA's notation, so $$\^$$ is the join and $$\v$$ is the meet. See [the previous post]({{ site.baseurl }}{% post_url 2019-02-23-exterior-6 %}) for details on OPG.

<!--more-->

------------

## 1. The Volume of a Simplex

We have seen that a (proper) $$k$$-simplex in oriented projective space $$\bb{O}^n$$ is an oriented $$k$$-triangle defined by $$k+1$$ points, like $$\alpha = (p_0 p_1 \ldots p_k)$$, and defines an oriented affine subspace (a $$k$$-flat) of $$\bb{O}^n$$. And we have seen that this flat can be represented as a multivector in homogenous coordinates, an element of $$\^ \bb{R}^{n+1}$$, via $$\alpha = (\b{w} + p_0) \^ (\b{w} + p_1) \^ \ldots (\b{w} + p_k) \in \^^{k+1} \bb{R}^{n+1}$$, where $$\b{w}$$ is the homogenous coordinate, which I always put at the front.

Let's consider the volume of simplexes, starting with a triangle in the plane as an illustrative eample. The area ($$2$$-volume) of a triangle defined by the points $$(a,b,c)$$ is given by

$$\text{area}(abc) = \frac{1}{2}(\vec{b}-\vec{a}) \^ (\vec{c}-\vec{a})$$

This is a bit weird, though, because it treats one vector as an 'origin', when we're just trying to talk about figures independent of coordinates. We can expand the product into the more symmetric form

$$\text{area}(abc) = \frac{1}{2}(\vec{a} \^ \vec{b} + \vec{b} \^ \vec{c} + \vec{c} \^ \vec{a})$$

Now we view each point as a unique direction in homogenous space $$\bb{R}^{3}$$. The homogenous coordinate will be called $$w$$, and we imagine that the triangle is drawn onto the projective plane given by $$w = 1$$. the triangle creates a tetrahedron with the origin, defined by $$\mathcal{O}, \b{w} + \vec{a}, \b{w} + \vec{b}, \b{w} + \vec{c}$$. But we already know that the oriented volume of the figure spanned by a set of vectors is given by their wedge product:

$$\text{vol}(\mathcal{O}abc) = \frac{1}{3!} (\b{w} + \vec{a}) \^ (\b{w} + \vec{b}) \^ (\b{w} + \vec{c})$$

(Without the $$\frac{1}{3!}$$ factor it would instead be the volume of the paralleliped with those vectors as its sides.)

The actual area $$\text{area}(abc)$$ is the area of the face opposite the origin, laying on the plane $$\b{w} = 1$$. So we can compute the volume of the tetrahedron, then contract with $$\b{w}$$ to remove the homogenous coordinate. The volume of a tetrahedron in general can be computed with its base and height, just like a triangle's $$\frac{1}{2}base \times height$$ formula: $$V = \frac{1}{3} \text{area}(base) \times height$$. Since the height of this tetrahedron is $$1$$, this just gives $$\text{area}(base) = 3\b{w} \cdot V$$. So we could instead write the area of the triangle as:

$$\begin{aligned}
\text{area}(abc) &= 3 \b{w} \cdot \text{vol}(\mathcal{O}abc) \\
&= 3 \b{w} \cdot \, \text{vol}((\b{w} + \vec{a}) \^ ( \b{w} +  \vec{b}) \^ (\b{w} + \vec{c})) \\
&= \frac{1}{2} (\vec{b} - \vec{a}) \^ (\vec{c} - \vec{a})
\end{aligned}$$

General formula

$$\text{vol}(p_1, p_2, \ldots p_{n+1}) = \frac{1}{n!} \b{w} \cdot \bigwedge_{1}^{n+1} (\b{w} + \vec{p}_i)  \tag{1}$$


Another way to write this is as the determinant of the $$(n+1) \times (n+1)$$-matrix spanned by the $$(1, \vec{p}_i)$$:

$$\text{vol}(p_1 p_2 \ldots p_{n+1}) = \frac{1}{n!} \un{n+1}{\det} \begin{pmatrix} 1 & \vec{p}_1 \\ 1 & \vec{p}_2 \\ \vdots & \vdots \\ 1 & \vec{p}_{n+1} \end{pmatrix} =\frac{1}{n!} \bigwedge^{n+1} \begin{pmatrix} 1 & \vec{p}_1 \\ 1 & \vec{p}_2 \\ \vdots & \vdots \\ 1 & \vec{p}_{n+1} \end{pmatrix}$$

For example:

$$\text{vol}(a,b,c) = \frac{1}{2!} \begin{pmatrix} 1 & a_x & a_y \\ 1 & b_x & b_y \\ 1 & c_x & c_y \end{pmatrix}$$

I'm mentioning these formulas primarily to show that they're quite symmetric and elegant.

When $$k < n$$, the volume $$k$$-simplex can still be computed by the same formula. However, the result is a multivector with multiple components instead of a scalar, representing an oriented area or volume in the larger space. We can map $$n$$-volumes to scalars only because they can be compared against the orientation of the enclosing space, but for a lesser volume, like the area of a arbitrary triangle floating in a larger space, there is nothing canonical to compare its orientation to.

When computing the volume of lesser-dimension simplexes the $$\b{w} \cdot$$ is critical or you will get the wrong answer. For example here's that triangle $$(abc)$$ floating in space in $$\bb{R}^3$$:

$$\begin{aligned}
\text{area}(abc) &= \b{w} \cdot \frac{1}{2!}(\b{w} + \vec{a}) \^ (\b{w} + \vec{b}) \^ (\b{w} + \vec{c})  \\
&= \frac{1}{2!} \b{w} \cdot [\vec{a} \^ \vec{b} \^ \vec{c} + \b{w} \^ (\vec{a} \^ \vec{b} + \vec{b} \^ \vec{c} + \vec{c} \^ \vec{a}  ] \\
&= \frac{1}{2!} (\vec{a} \^ \vec{b} + \vec{b} \^ \vec{c} + \vec{c} \^ \vec{a}) \\
&= \frac{1}{2!} (\vec{b} - \vec{a}) \^ (\vec{c} - \vec{a})
\end{aligned}$$

The $$\b{w} \cdot$$ prevents us from including the $$\vec{a} \^ \vec{b} \^ \vec{c}$$ term, which was zero in 2d but in 3d is the volume of the tetrahedron $$(\mathcal{O}abc)$$. It's a meaningful quantity, but not for computing the area. 

So formula $$(1)$$ works with $$k < n$$:

$$\text{vol}(p_1 p_2 \ldots p_{k+1}) = \b{w} \cdot \frac{1}{k!} \bigwedge_{i=1}^{k+1} (\b{w} + p_i) \tag{2}$$

By the way: even if all of this is elegant and symmetric and all those things we like, it's not that _efficient_. It will in most cases be more better to use the $$\frac{1}{n!} (p_1 - p_0) \^ \ldots (p_k - p_0)$$ formula to actaully compute volumes, since it is a product of only $$n$$ vectors.

----------

## 3. The Boundary Operator

Even if $$\^^2 (abc)$$ is not exactly the area of $$(abc)$$, the components of $$\^^2 (abc)$$ are meaningful: they are the simplexes which form the boundary of $$(abc)$$. Apparently, to compute the volume of a triangle $$(abc)$$, we compute its boundary chain, which is a formal linear combination of the simplexes $$(ab) + (bc) + (ca)$$, and then add each of their volumes together by identifying them as living in a common space.

The operation of taking the boundary of a simplex is a common operation on simplexes anywhere they're used. The boundary of the $$k$$-simplex $$p = (p_0, p_1, \ldots p_k)$$ is the chain / formal linear combination of $$(k-1)$$-simplexes given by:

$$\p p = \sum_j (-1)^{j} (p_0, \ldots p_{j-1}, p_{j+1}, \ldots p_k) \tag{3}$$

And then extended linearly over chains. That is: we omit one vertex at a time and produce an alternating sum of the results. The boundary consists of one simplex for each facet (the generic term for a vertex, edge, face, etc of a figure) of $$p$$. Examples (we define boundary of a point as the empty set):

$$\begin{aligned}
\p(a) &= () \\
\p(ab) &= (b) - (a) \\
\p(abc) &= (bc) - (ac) + (ab)  = (ab) + (bc) + (ca) \\
\p(abcd) &= (bcd) - (acd) + (abd) - (abc)
\end{aligned}$$

This is the [standard definition](https://en.wikipedia.org/wiki/Simplex#Algebraic_topology). I'm not sure I agree with its choice of signs -- it's strange that the prefix simplex $$(p_0 p_1 \ldots p_{k-1})$$ is negative sometimes and positive other times; I would just define things so that it's always positive. But perhaps it doesn't matter. 

------

We can take the boundary in the $$S$$ or $$\bb{O}^n$$ representations. In $$S$$, these are linear combinations of objects in different subspaces, so we can't do anything further than formally add and subtract them. That is, $$(b) - (a)$$ is something like $$(b) \b{e}_1 - (a) \b{e}_2$$. When we map $$S \ra \bb{O}^n$$ and each point gets mapped to its coordinates, this becomes the net displacement of the simplex as a $$k$$-vector, for instance $$(b) - (a) \ra \vec{b} - \vec{a}$$.

Conceptually, the boundary operator produces the oriented boundary $$(k-1)$$-chain of the $$k$$-simplex $$p$$. Except for $$k=1$$, these boundary simplexes will share edges with each other, tiling $$p$$ such that their edges cancel out. For instance: in the triangle $$(abc)$$, with $$\p(abc) = (ab) + (bc) + (ca)$$, each of the points $$(a), (b), (c)$$ is the endpoint of one side and the initial point of another. Likewise for the edges shared by faces in a tetrahedron, or any more complex closed shape. So it will be no surprise that "the boundary of a boundary is $$0$$", in the sense that all their components formally cancel:

$$\p^2 = 0 \tag{4}$$

This is also readily computed from the algebraic definition (3).[^calculus] Note that this refers to the $$\p^2$$ operator after we identify objects with the negation of their opposites: $$(ab) = - (ba)$$. Until we have done this, $$\p^2 P$$ is just a sum of things that _will_ cancel, like $$(a) + \neg(a)$$, but they have not cancelled yet:

$$\p^2(abc) = b + \neg a + c + \neg b + a + \neg c \\
\Ra (b-a) + (c-b) + (a-c) = 0$$

[^calculus]: By the way: chains and boundaries are key concepts in calculus: chains are the things which we integrate differential forms along, and this boundary operator is the one which appears in Stokes' theorem $$\int_{w} df = \oint_{\p w} f$$, and $$\p^2 = 0$$ is more or less equivalent to $$d^2 = 0$$ which is why the divergence of the curl of a vector field is $$0$$. But that's for another time.

It is clear that there is a connection between the boundary operator and wedge powers. Consider that the $$(n-1)$$'th wedge power of a matrix produces the same subsets with the same signs:

$$\^^2 (\vec{a}, \vec{b}, \vec{c}) = (\vec{b} \^ \vec{c}, - (\vec{a} \^ \vec{c}), \vec{a} \^ \vec{b})$$

After this the two operations are slightly different, which is why it's not true that $$\^^{n-2} = 0$$. Consider $$\p^2(abc) = (b - a + c - b + a - c)$$, but $$\^^1 (abc) = (a + b + c)$$. In some sense $$\p^2(abc) = \^^2 (abc) + \^^2 (\neg (abc)) = \^^2 (abc - abc) = 0$$.

------

We saw earlier that

$$\begin{aligned}
\text{vol}(abc) &= \vec{a} \^ \vec{b} + \vec{b} \^ \vec{c} + \vec{c} \^ \vec{a} \\
&= \text{vol}(\mathcal{O}ab + \mathcal{O}bc - \mathcal{O}ca)\\
&= \text{vol}(\mathcal{O} \p(abc))
\end{aligned}$$

This seems to say that the volume of a simplex in $$\bb{O}^n$$ is the volume of its boundary when considered as vectors from the origin. Thus, $$\p^2$$ means that the sum of the volumes of the boundaries of a figure are 0:

$$\text{vol} (\p(abcd)) = \text{vol}(\mathcal{O} \p^2(abcd)) = 0$$

Our triangle, for instance, has $$\p(ab + bc + ca) = (b-a) + (c-b) + (a-c) = 0$$.

Thus, I think we have a solution to the problem of the previous section. If we do not want to get into the philosophical problems with regarding simplexes as linear transformations, we can just write the area-vector of the simplex $$(abc)$$ as $$\frac{1}{2!} \p(abc) = \frac{1}{2!}((ab) + (bc) + (ca))$$ and leave it at that. Generally, let $$\phi: S \ra \bb{R}^n$$ be the map which takes abstract points to their vector representations; then the volume of a $$k$$-simplex $$P$$ in $$\bb{R}^n$$ is:

$$\text{vol}(P) = \frac{1}{k!} \phi^{\^ k}( \p P) \in \^^k \bb{R}^n \tag{5}$$

Of course, we can only compute $$\p$$ if we get the figure as a list of points, or as a multivector in homogenous coordinates. The vector value $$\vec{a} \^ \vec{b} \^ \vec{c}$$ would not help us at all with computing $$ab + bc + ca$$. Nevertheless, this all makes me wonder if perhaps the $$\b{w}$$-coordinate in OPG is not necessary and could be removed if we were more adept at thinking in wedge products. More on that next time...

--------

## 4. The Shoelace Formula

We can also take the boundary of chains that are not simplexes, and it does what we would like. For instance the boundary of a chain of connected line segments that don't form a closed loop is formal difference of their endpoints:

$$\p((ab) + (bc) + (cd)) = (b) - (a) + (c) - (b) + (d) - (c) \\
= (d) - (a)$$

Which is basically exactly what we would expect: the internal points _do_ cancel out, leaving only the endpoints of the chain. But even if the internal points didn't cancel, remaining as $$(b) \b{e}_1 - (b) \b{e}_2$$, we're left with an object which we can add cancellation to later, by identifying $$\b{e}_1 = \b{e}_2$$.


We can represent a general polygon (or any polytope) as a chain of the oriented simplexes which compose it. For example, consider the five-sided figure $$P$$ created by the points $$(a,b,c,d,e)$$ in the plane. $$P$$ can be decomposed into simplexes as $$P = (abc) + (acd) + (ade)$$. Then the boundary operator produces only the _external_ boundaries, because the internal boundaries all cancel out:

$$\begin{aligned}
\p P &= \p(abc) + \p(acd) + \p(ade) \\
&= (bc) + (ca) + (ab) + (cd) + (da) + (ac) + (de) + (ea) + (ad) \\
&=[(ac) - (ac)] + [(ad) - (ad)] + (bc) + (ab) + (cd) + (de) + (ea) \\
&= (ab) + (bc) + (cd) + (de) + (ea)
\end{aligned}$$

But as we saw before, this (with a factor of $$\frac{1}{2}$$) is the area of the figure, when regarded as a sum of multivectors. Thus:

$$\text{area}(P) = \frac{1}{2} [\p(abc) + \p(acd) + \p(ade)] = \frac{1}{2}[(ab) + (bc) + (cd) + (de) + (ea)]$$

Where the final addition is performed treating each object as a multivector $$\in \bb{R}^n$$.

This is the [shoelace formula](https://en.wikipedia.org/wiki/Shoelace_formula) for the area of a polygon, which I wrote an [expository post]({{ site.baseurl }}{% post_url 2018-08-06-oriented-area %}) about before I had really studied EA in any depth. I knew it was going to show up...

Clearly the same form generalizes to any dimension. However, it gets a lot harder to use, just because we have to decompose our $$n$$-polytope into $$n$$-simplexes, which is painful in practice. But if we do it, we can can compute the oriented volume of any $$n$$-polytope.

-----


## 5. Scalar Volumes

The multivector volume of a $$k$$-simplex $$P$$ is $$\frac{1}{k!} \p P $$ regarded as a multivector $$\in \^^k \bb{R}^n$$. Since this is not in general a scalar, we might want to take its norm:

$$\| \text{vol}(P) \|^2 = \frac{1}{(k!)^2} \| \p P \|^2 $$

For a line segment $$(ab)$$ this is just its squared length: $$\| \text{vol}(ab) \|^2 = \| \vec{b} - \vec{a} \|^2$$, which reminds us that the vector representation of a line segment is its vector displacement. For a point, it doesn't seem to be meaningful: $$\|\text{vol}(p)\|^2 = \frac{1}{0!^2} \| \emptyset \|^2 \stackrel{?}{=} 1$$.

Since we can write $$\p P$$ as the $$\^^k$$ power of $$P$$'s matrix representation, we can write, using Cauchy-Binet ($$\^^q AB = \^^q A \^^q B$$) and the definition of the multivector inner product, an expression for the volume as the determinant of a symmetric matrix:

$$\begin{aligned}
(k!)^2 \| \text{vol}(P) \|^2 &= \det [(\^^k P) (\^^k P)^T] \\
&= \det (\^^k [PP^T]) \\
&= \det (\^^k \begin{pmatrix} p_0 \cdot p_0 & p_0 \cdot p_1 & \ldots \\ p_1 \cdot p_0 & p_1 \cdot p_1 & \ldots \\ \vdots & \vdots & \ddots \end{pmatrix} )
\end{aligned}$$

For instance for the triangle $$(abc)$$:

$$|\text{vol}(abc)|^2 = \frac{1}{(2!)^2} \det \^^2 \begin{pmatrix} a \cdot a & a \cdot b & a \cdot c \\ b \cdot a & b \cdot b & b \cdot c \\ c \cdot a & c \cdot b & c \cdot c \end{pmatrix}$$

I am not entirely sure what's going on when we take the determinant (a $$\^^{k+1}$$ power) of a $$\^^k$$ power. I'm sure there's a deep understanding there I haven't found yet. Lacking an elegant transformation, let's instead  write $$\text{vol}(P)$$ as $$\frac{1}{k!}(p_1 - p_0) \^ (p_2 - p_0) \ldots \^ (p_k - p_0)$$, giving

$$\begin{aligned}
(k!)^2 \| \text{vol}(P) \|^2 &= \det \begin{pmatrix} 
\| p_1 - p_0 \|^2 & (p_1 - p_0)\cdot(p_2 - p_0) & \ldots \\
(p_2 - p_0)\cdot(p_1 - p_0) & \| p_2 - p_0 \|^2 & \ldots \\
\vdots & \vdots & \ddots
\end{pmatrix}
\end{aligned}$$

Writing $$L_{ij} = \| p_j - p_i \|$$ for the length of the $$ij$$'th side, we can check that

$$\begin{aligned}
L_{ij}^2 &= |p_j - p_i|^2  \\
&= |(p_j - p_0) - (p_i - p_0)|^2 \\
&= |p_j - p_0|^2 + |p_i - p_0|^2 - 2 (p_j - p_0) \cdot (p_i - p_0) \\
 (p_j - p_0) \cdot (p_i - p_0) &= \frac{1}{2} (L_{j0}^2 + L_{i0}^2 - L_{ij}^2)
\end{aligned}$$

Substituting into the previous determinant gives (one form of) the [Cayley-Menger determinant](https://en.wikipedia.org/wiki/Cayley%E2%80%93Menger_determinant) formula, which expresses the volume of a simplex in terms of only its squared side lengths, a large symmetric polynomial in the coefficients.

$$
| \text{vol}(P) |^2 = \frac{1}{k!^2 2^k} \det
\begin{pmatrix} 2L_{02}^2 & L_{01}^2 + L_{02}^2 - L_{12}^2 & \ldots \\
L_{01}^2 + L_{02}^2 - L_{12}^2 & 2L_{02}^2 & \ldots \\
\vdots & \vdots & \ddots \end{pmatrix}
$$

There are a couple other expressions for the same thing which include extra rows or columns of $$1$$s on the outside the matrix; presumably because they were not aware of smaller wedge powers than determinants.

For our triangle, if we label the side lengths $$A,B,C$$:

$$|\text{area}(abc)|^2 = \frac{1}{16} \det \begin{pmatrix} 2A^2 & A^2 + B^2 - C^2 \\ A^2 + B^2 - C^2 & 2B^2 \end{pmatrix}$$

Some brief manipulations turn this into [Heron's Formula](https://en.wikipedia.org/wiki/Cayley%E2%80%93Menger_determinant) using the semiperimeter $$s = \frac{A + B + C}{2}$$: $$area(abc) = \sqrt{s (s-A) (s-B) (s-C)}$$. I've long wondered where that comes from, and I guess I still don't really quite get it but at least it's clear where to start if I wanted to generalize to other dimensions.

{% include ea.html %}
